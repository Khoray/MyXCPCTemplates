\section{Math Formula}

\subsection{多项式牛顿迭代}

\subsection{牛顿恒等式}
设 $p_k$ is k-th power sum, $p_k=\sum_{i=1}^n a_i^k$，$e_k$ 是$k$个$a$的轮换和。

设 $E(x)=1+e_1x+e_2x^2+...$.

\begin{equation*}
    \begin{aligned}
        \prod_{i=1}^n (1+a_ix)&=E(x)\\
        (\ln \prod_{i=1}^n (1+a_ix))'&=E'(x)/E(x)\\
        \sum_{i=1}^n \frac{a_i}{1+a_ix}&=E'(x)/E(x)\\
        E'(x)/E(x)&=\sum_{i=1}^n\sum_{j\ge 0}(-1)^{j}a_i^{j+1}x^j\\
        &=\sum_{j\ge 0}(-1)^j\left(\sum_{i=1}^n a_i^{j+1}\right)x^j\\
        &=\sum_{j\ge 0}(-1)^j p_{j+1} x^j
    \end{aligned}
\end{equation*}

结论：
\begin{equation*}
    \begin{aligned}
        ke_k&=\sum_{i=1}^{k}(-1)^{i-1}e_{k-i}p_i &(k\le n)\\
        0&=\sum_{i=k-n}^k(-1)^{i-1}e_{k-i}p_i&(k>n)
    \end{aligned}
\end{equation*}

\begin{equation*}
    \begin{aligned}
        e_1 &=p_1 \\
        2 e_2 &=e_1 p_1-p_2=p_1^2-p_2 \\
        3 e_3 &=e_2 p_1-e_1 p_2+p_3=\frac{1}{2} p_1^3-\frac{3}{2} p_1 p_2+p_3 \\
        4 e_4 &=e_3 p_1-e_2 p_2+e_1 p_3-p_4=\frac{1}{6} p_1^4-p_1^2 p_2+\frac{4}{3} p_1 p_3+\frac{1}{2} p_2^2-p_4,\\
        e_k(k>n)&=0
    \end{aligned}
\end{equation*}


\begin{equation*}
    \begin{aligned}
        &p_1=e_1 \\
        &p_2=e_1 p_1-2 e_2=e_1^2-2 e_2 \\
        &p_3=e_1 p_2-e_2 p_1+3 e_3=e_1^3-3 e_1 e_2+3 e_3 \\
        &p_4=e_1 p_3-e_2 p_2+e_3 p_1-4 e_4=e_1^4-4 e_1^2 e_2+4 e_1 e_3+2 e_2^2-4 e_4,\\
        &p_k=(-1)^{k-1} k e_k+\sum_{i=1}^{k-1}(-1)^{k-1+i} e_{k-i}\left(x_1, \ldots, x_n\right) p_i (k\le n)\\
        &p_k=\sum_{i=k-n}^{k-1}(-1)^{k-1+i} e_{k-i} p_i (k>n)
    \end{aligned}
\end{equation*}




\subsection{生成函数/形式幂级数}
\subsubsection{麦克劳林展开}
\begin{equation*}
    \begin{aligned}
        &\frac{1}{1-x}=1+x+\cdots+x^n+\cdots\\
        &\frac{1}{1+x}=1-x+x^2+\cdots+(-1)^n x^n+\cdots\\
        &\ln (1+x)=x-\frac{x^2}{2}+\cdots+\frac{(-1)^{n-1} x^n}{n}+\cdots\\
        &\mathrm{e}^x=1+x+\cdots+\frac{x^n}{n !}+\cdots\\
        &(1+x)^\alpha=1+\alpha x+\frac{\alpha(\alpha-1)}{2 !} x^2+\cdots+\frac{\alpha(\alpha-1)\cdots(\alpha-n+1)}{n!}+\cdots\\
        &\sin x=\frac{x^3}{3 !}+\cdots+\frac{(-1)^n x^{2 n+1}}{(2 n+1) !}+\cdots\\
        &\cos x=1-\frac{x^2}{2 !}+\cdots+\frac{(-1)^n x^{2 n}}{(2 n) !}+\cdots\\
    \end{aligned}
\end{equation*}
\subsection{数论公式}
\subsubsection{莫比乌斯反演}
一般反演:
\begin{equation*}
    \begin{aligned}
        f(n)=\sum_{d\mid n}g(d) \Longleftrightarrow g(n)=\sum_{d\mid n} \mu (d)f(\frac{n}{d})\\
        f(n)=\sum_{\substack{n\mid d\\ d\le N}}g(d) \Longleftrightarrow g(n)=\sum_{\substack{n\mid d\\ d\le N}} \mu (\frac{d}{n})f(d)
    \end{aligned}
\end{equation*}

gcd 反演结论:
\begin{equation*}
    [\operatorname{gcd}(i, j)=1]=\sum_{d \mid \operatorname{gcd}(i, j)} \mu(d)
\end{equation*}
\subsubsection{杜教筛}
\begin{equation*}
    g(1) S(n)=\sum_{i=1}^{n}(f * g)(i)-\sum_{i=2}^{n} g(i) S\left(\left\lfloor\frac{n}{i}\right\rfloor\right)
\end{equation*}
\subsubsection{Min\_25筛/Ex-Eratosthenes-Sieve}
第一步：筛出所有质数部分（此处的$g(n)$是$f(n),n\in \mathbb{P}$的通项公式）
\begin{equation*}
    \begin{array}{c}
        G_{k}(n):=\sum_{i=1}^{n}\left[p_{k}<\operatorname{lpf}(i) \vee \operatorname{isprime}(i)\right] g(i)\\
        G_{k}(n)=G_{k-1}(n)-\left[p_{k}^{2} \leq n\right] g\left(p_{k}\right)\left(G_{k-1}\left(n / p_{k}\right)-G_{k-1}\left(p_{k-1}\right)\right)
    \end{array}
\end{equation*}
第二部：筛出质数和合数部分,我们令 $F_{\text{prime}}(n)=\sum_{\substack{2\le p\le n\\ p\in \text{prime}}}f(p)$
\begin{equation*}
    \begin{aligned} 
        F_{k}(n) &= \sum_{i = 2}^{n} [p_{k} \le \operatorname{lpf}(i)] f(i) \ \\
        &= \sum_{\substack{k \le i \\ p_{i}^{2} \le n}} \sum_{\substack{c \ge 1 \\ p_{i}^{c} \le n}} f\left(p_{i}^{c}\right) ([c > 1] + F_{i + 1}\left(n / p_{i}^{c}\right)) + \sum_{\substack{k \le i \\ p_{i} \le n}} f(p_{i}) \ \\
        &{= \sum_{\substack{k \le i \\ p_{i}^{2} \le n}} \sum_{\substack{c \ge 1 \\ p_{i}^{c} \le n}} f\left(p_{i}^{c}\right) ([c > 1] + F_{i + 1}\left(n / p_{i}^{c}\right)) + F_{\mathrm{prime}}(n) - F_{\mathrm{prime}}(p_{k - 1})}\text{常用！！} \ \\
        &= \sum_{\substack{k \le i \\ p_{i}^{2} \le n}} \sum_{\substack{c \ge 1 \\ p_{i}^{c + 1} \le n}} \left(f\left(p_{i}^{c}\right) F_{i + 1}\left(n / p_{i}^{c}\right) + f\left(p_{i}^{c + 1}\right)\right) + F_{\mathrm{prime}}(n) - F_{\mathrm{prime}}(p_{k - 1}) 
    \end{aligned}
\end{equation*}

\lstinputlisting{code/math/min25.cpp}



\subsection{分配问题}

\begin{enumerate}
    \item $n$ 个球放到 $k$ 个盒子，每个盒子只有一种形态。

    $$
    \begin{array}{cc|cc}
    \hline n \text { 个球 } & k \text { 个盒子 } & \text { 盒子可以为空 } & \text { 每个盒子内至少有一个球 } \\
    \hline \text { 有标号 } & \text { 有标号 } & k^{n} & k ! S_{2}(n, k) \\
    \text { 有标号 } & \text { 无标号 } & \sum_{i=1}^{k} S_{2}(n, i) & S_{2}(n, k) \\
    \text { 无标号 } & \text { 有标号 } & C(n+k-1, k-1) & C(n-1, k-1) \\
    \text { 无标号 } & \text { 无标号 } & p(n+k, k) & p(n, k) \\
    \hline
    \end{array}
    $$

    其中 $S_2(n,k)$ 为第二类 `Stirling数` ，$p(n,k)$ 为 `分拆数`

    \item $n$ 个球放到 $k$ 个盒子, 每个盒子至少一个球，装有 $i$ 个球的盒子有 $f_i$ ($i\ge1$) 种形态。

    $F(x) $ 是 $f_i$ 的 $o.g.f.$ ，$E(x)$ 是 $f_i$ 的 $e.g.f.$
    $$
    \begin{array}{cc|c}
    \hline n \text { 个球 } & k \text { 个盒子 } & \text { 关于 $n$ 方案的生成函数 } \\
    \hline \text { 有标号 } & \text { 有标号 } & e . g . f=E(x)^{k} \\
    \text { 有标号 } & \text { 无标号 } &  { e.g.f }=\frac{1}{k !} E(x)^{k} \\
    \text { 无标号 } & \text { 有标号 } &  { o.g.f }=F(x)^{k} \\
    \text { 无标号 } & \text { 无标号 } & \text { 不会 } \\
    \hline
    \end{array}
    $$


    \item $n$ 个球放到若干盒子，每个盒子至少一个球，装有 $i$ 个球的盒子有 $f_i$ ($i\ge1$) 种形态.

    $$
    \begin{array}{cc|c}
    \hline n \text { 个球 } & \text { 盒子 } & \text { 方案的生成函数 } \\
    \hline \text { 有标号 } & \text { 有标号 } & e . g . f=\frac{1}{1-E(x)} \\
    \text { 有标号 } & \text { 无标号 } &  { e.g.f }=\exp (E(x)) \\
    \text { 无标号 } & \text { 有标号 } &  { o.g.f }=\frac{1}{1-F(x)} \\
    \text { 无标号 } & \text { 无标号 } & o . g . f=\prod_{i \geq 1}\left(\frac{1}{1-x^{i}}\right)^{f_{i}}=\exp \left(\sum_{j \geq 1} \frac{1}{j} F\left(x^{j}\right)\right) \\
    \hline
    \end{array}
    $$
\end{enumerate}

\subsection{第二类斯特林数}

性质：
\begin{enumerate}
    \item ${n\brace k}={n-1\brace k-1}+k{n-1\brace k}$ 边界条件 ${x\neq 1\brace 0}=0,{0\brace 0}=1$
    \item ${n\brace k}=\frac{1}{k!}\sum\limits_{i=0}^{k}(-1)^i\binom{k}{i}(k-i)^{n}$ （用来求第二类斯特林数·行，考虑容斥）
    \item $k^n=\sum\limits_{i=0}^k {n\brace i} k^{\underline{i}}$ （性质 2 的反演）
    \item 重要公式：$x^n=\sum\limits_{k=0}^{n}{n\brace k}x^{\underline k}$ （基于 3，$x$ 个球 $n$ 个盒子）
    \item 关于 $n$ 的 $e.g.f.=\dfrac{(e^x-1)^k}{k!}$ （考虑将 $n$ 个物品染成 $k$ 种颜色，每一种物品的指数生成函数为 $e^x-1$ ）（用于求第二类斯特林数·列）
\end{enumerate}

\subsection{第一类斯特林数}

性质：
\begin{enumerate}
    \item ${n\brack k}={n-1\brack k-1}+(n-1){n-1\brack k}$ 边界条件 ${x\neq1\brack 0}=0,{0\brack 0}=1$
    \item 重要公式：$x^{\overline n}=\sum\limits_{k=0}^{n}{n\brack k}x^n$ （$x$ 个球 $n$ 个盒子）(用于计算第一类斯特林数·行)
    \item 有符号的第一类斯特林数：$S_1(n,k)=(-1)^{n+k}{n\brack k}$
    
    $x^{\underline n}=\sum\limits_{k=0}^{n}S_1(n,k)x^n$
    \item 关于 $n$ 的 $e.g.f.=\dfrac{(-\ln(1-x))^k}{k!}$. (列)
\end{enumerate}

\subsection{分拆数}

性质：
\begin{enumerate}
    \item $p(n,k)=p(n-1,k-1)+p(n-k,k)$
    \item $o.g.f. = x^k \prod\limits_{i=1}^k \frac{1}{1-x^i}$ （考虑 Ferrers 图中长度为 $i$ 的一列有多少个）
\end{enumerate}

\subsection{五边形数}

性质：
\begin{enumerate}
    \item $p(n)=\sum\limits_{k=1}^{n}p(n,k)$
    \item $o.g.f.=\prod\limits_{i\ge1}{\frac{1}{1-x^i}}$\\
    考虑求 $\ln$ , $o.g.f.=\exp(\sum_{n\ge1}{\sum_{d\mid n} {\frac{x^n}{d}}})$ $O(n\log{n})$
    \item 递推公式：
        \begin{enumerate}
            \item 考虑 $Q(x)=\prod_{i\ge1}(1-x^i)$
            \item $Q(x)=\sum_{n\ge0}(q_{even}(n)-q_{odd}(n))x^n，其中 $ $q_{even/odd}$ 表示有偶数/奇数行，每一行的个数都不相同，大部分 $q_{even}(n)$ 和 $q_{odd}(n)$ 抵消，小部分也就是有 $b$ 行，$n=\frac{b(3b-1)}{2}$ 和 $n=\frac{b(3b+1)}{2}$ 无法抵消。其系数都是 $(-1)^b$
            \item 则 $Q(x)=1+\sum_{i\ge1}(-1)^ix^{\dfrac{(3i\pm1)i}{2}}$
            \item $P(x)=Q^{-1}(x)$ 则，$p(n)=\sum_{k\ge1}(-1)^{k-1}\left(p\left(n-\dfrac{(3k-1)k}{2}\right)+p\left(n-\dfrac{(3k+1)k}{2}\right)\right)$
        \end{enumerate}
\end{enumerate}

\subsection{Polya}

\paragraph{置换群}\

$G$ 是置换的集合，$◦$ 是置换的复合，且 $(G, ◦)$ 为一个群时，称 $(G, ◦)$ 为一个置换群。 \\


\noindent 旋转群：

设 $n$ 元环的 $n$ 个结点分别为 $a_1,a_2, ...,a_n$，旋转操作可以看成 $A = {a_1, ..., a_n}$ 上的 $n$ 个置换，其中第 $i$ 个置换为 $g_i = [i + 1,i + 2, ...,n,1, ...,i]$。 

设集合 $G= \{g_0,g_1, ...,g_{n−1}\}$，则 $(G,◦)$ 是一个置换群，称为正 $n$ 边形的旋转群。\\

\paragraph{群对集合的作用}\

一个操作会将一个对象改变为另一个对象，形式化地：

设 $(G, \circ)$ 是一个群, 其单位元为 $e, X$ 是一个集合, 群 $G$ 对集合 $X$ 的一个作用是一个 $G \times X$ 到 $X$ 的映射 $f$, 满足:

\begin{itemize}
    \item $\forall x \in X . f(e, x)=x$
    \item $\forall g, h \in G . f(h \circ g, x)=f(h, f(g, x))$
    我们把 $f(g, x)$ 简记成 $g_{f}(x)$ 或（在没有歧义的情况下记成） $g(x)$ 。
\end{itemize}

\begin{itemize}
    \item 设 $n$ 元环的 $n$ 个结点分别为 $a_{1}, a_{2}, \ldots, a_{n}$, 令 $A=\left\{a_{1}, \ldots, a_{n}\right\}$ 。设颜色集合为 $B=\left\{b_{1}, b_{2}, \ldots, b_{m}\right\}$ 。给 $n$ 元环染色可以看成 $A$ 到 $B$ 的一个映射 $x: A \rightarrow B$, 令 $X$ 是 所有这些映射的集合, 即 $X=\{x \mid x: A \rightarrow B\}$ 。
    \item 令 $G=\left\{g_{0}, g_{1}, \ldots, g_{n-1}\right\}$ 是正 $n$ 边形的旋转群, 定义 $G \times X$ 到集合 $X$ 的映射 $f$, 其中 $\forall i=0 . . n-1, x \in X . y=f\left(g_{i}, x\right)$ 满足 $\forall j=1 . . n . y\left(a_{j}\right)=x\left(g_{i}\left(a_{j}\right)\right)$, 可以证明 $f$ 是群 $G$ 到集合 $X$ 的一个作用, 因此我们简记 $y=f\left(g_{i}, x\right)$ 为 $y=g_{i}(x)$ 。
    \item $X$ 上的 $G$ 关系为 $R_{G}=\{(x, y) \mid x, y \in X \wedge(\exists g \in G . y=g(x))\}, x R_{G} y$ 当且仅当染色 方案 $x$ 能通过旋转得到 $y$ 。
\end{itemize}

要求所有不同的染色方案, 即是求 $X$ 上的 $G$-轨道的数量。\\

\paragraph{Burnside 引理}\

设有限群 $(G, \circ)$ 作用在有限集 $X$ 上, 则 $X$ 上的 $G$-轨道数量为
$$
N=\frac{1}{|G|} \sum_{g \in G} \Psi(g)
$$
其中 $\Psi(g)$ 表示 $g(x)=x$ 的 $x$ 的数量。\\

\paragraph{轮换指标}\

设 $(G, \circ)$ 是一个 $n$ 元置换的置换群, 它的轮换指标为
$$
P_{G}\left(x_{1}, x_{2}, \ldots, x_{n}\right)=\frac{1}{|G|} \sum_{g \in G} x_{1}^{b_{1}} x_{2}^{b_{2}} \ldots x_{n}^{b_{n}}
$$
$x_i^{b_i}$ 表示 $g$ 这个置换的长度为 $i$ 的环有 $b_i$ 个。

正 $n$ 边形旋转群轮换指标:

$$
P_G=\frac{1}{n}\sum_{d\mid n}\varphi(d)x_d^{n/d}
$$

正 $n$ 边形二面体群轮换指标(即可对称):

$$
P_{G}=\frac{1}{2 n} \sum_{d \mid n} \varphi(d) x_{d}^{n / d}+\left\{\begin{array}{ll}
\frac{1}{2} x_{1} x_{2}^{\frac{n-1}{2}}, \quad &n \text { 为奇数 } \\
\frac{1}{4}\left(x_{2}^{\frac{n}{2}}+x_{1}^{2} x_{2}^{\frac{n-2}{2}}\right), &n \text { 为偶数 }
\end{array}\right.
$$

正方体置换群：

顶点置换群:

$$
P_{G}=\frac{1}{24}\left(x_{1}^{8}+8 x_{1}^{2} x_{3}^{2}+9 x_{2}^{4}+6 x_{4}^{2}\right)
$$

边置换群:

$$
P_{G}=\frac{1}{24}\left(x_{1}^{12}+8 x_{3}^{4}+6 x_{1}^{2} x_{2}^{5}+3 x_{2}^{6}+6 x_{4}^{3}\right)
$$

面置换群：

$$
P_{G}=\frac{1}{24}\left(x_{1}^{6}+8 x_{3}^{2}+6 x_{2}^{3}+3 x_{1}^{2} x_{2}^{2}+6 x_{1}^{2} x_{4}\right)
$$



\paragraph{Polya 定理}\

集合 $X$ 可以看成是给集合 $A=\left\{a_{1}, a_{2}, \ldots, a_{n}\right\}$ 的每个元素赋予式样（颜色, 种类等） 的映射的集合

引入表示式样的集合 $B$, 令 $X=\{x \mid x: A \rightarrow B\}$, 记为 $B^{A}$

\textbf{式样清单}: $G$ 作用在 $B^{A}$ 上的 $G$-轨道的集合称为 $B^{A}$ 关于 $G$ 的\textbf{式样清单}，记为 $F$

种类的权值: 假设 $B$ 上的每个元素 $b$ 都赋予了权值 $w(b)$

$f \in B^{A}$ 的权值: 定义 $w(f):=\prod_{a \in A} w(f(a))$

$G$-轨道的权值: $w(F):=w(f)$, 任选一个 $f \in F$

定理：

$B^{A}$ 关于 $G$ 的\textbf{式样清单}记为 $\mathcal{F}$, 则
$$
\sum_{F \in \mathcal{F}} w(F)=P_{G}\left(\sum_{b \in B} w(b), \sum_{b \in B} w(b)^{2}, \ldots, \sum_{b \in B} w(b)^{n}\right)
$$